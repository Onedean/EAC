2024-09-15 14:40:26,149 - logger name:log/ENGERY/oneline_st_nn_engery-43/oneline_st_nn_engery.log
2024-09-15 14:40:26,149 - params : {'conf': 'new_conf/ENGERY/oneline_st_nn_engery.json', 'seed': 43, 'paral': 0, 'gpuid': 1, 'logname': 'oneline_st_nn_engery', 'method': 'TrafficStream', 'load_first_year': 0, 'first_year_model_path': 'log/PEMS/trafficstream-42/2011/16.6936.pkl', 'device': device(type='cuda', index=1), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>}, 'begin_year': 0, 'end_year': 3, 'dropout': 0.0, 'lr': 0.01, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': 'data/ENGERY/RawData/', 'save_data_path': 'data/ENGERY/FastData/', 'graph_path': 'data/ENGERY/graph/', 'model_path': 'log/ENGERY/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'incremental', 'increase': True, 'num_hops': 2, 'detect': False, 'ewc': False, 'replay': False, 'path': 'log/ENGERY/oneline_st_nn_engery-47', 'logger': <Logger utils.initialize (INFO)>}
2024-09-15 14:40:26,157 - [*] Year 0 load from data/ENGERY/FastData/0.npz
2024-09-15 14:40:26,371 - [*] Year 0 Dataset load!
2024-09-15 14:40:26,373 - Total Parameters: 3308
2024-09-15 14:40:26,373 - Trainable Parameters: 3308
2024-09-15 14:40:26,374 - [*] Year 0 Training start
2024-09-15 14:40:26,933 - node number torch.Size([13184, 12])
2024-09-15 14:40:28,191 - epoch:0, training loss:238752.3491 validation loss:223.0784
2024-09-15 14:40:29,589 - epoch:1, training loss:101369.6536 validation loss:179.2030
2024-09-15 14:40:30,985 - epoch:2, training loss:80851.3657 validation loss:175.1776
2024-09-15 14:40:32,402 - epoch:3, training loss:78080.6955 validation loss:171.6135
2024-09-15 14:40:33,737 - epoch:4, training loss:76365.3667 validation loss:178.2244
2024-09-15 14:40:35,072 - epoch:5, training loss:76177.6584 validation loss:163.1819
2024-09-15 14:40:36,449 - epoch:6, training loss:76046.7759 validation loss:171.1814
2024-09-15 14:40:37,807 - epoch:7, training loss:76192.3551 validation loss:177.6131
2024-09-15 14:40:39,178 - epoch:8, training loss:74848.4931 validation loss:179.1938
2024-09-15 14:40:40,550 - epoch:9, training loss:74549.6045 validation loss:175.0264
2024-09-15 14:40:41,921 - epoch:10, training loss:75081.3254 validation loss:167.1164
2024-09-15 14:40:43,509 - epoch:11, training loss:74376.1659 validation loss:168.2956
2024-09-15 14:40:44,174 - [*] loss:95365.1406
2024-09-15 14:40:44,179 - [*] year 0, testing
2024-09-15 14:40:44,239 - T:3	MAE	159.2168	RMSE	236.1382	MAPE	2552.0815
2024-09-15 14:40:44,358 - T:6	MAE	181.3109	RMSE	268.4223	MAPE	3096.5988
2024-09-15 14:40:44,697 - T:12	MAE	216.4177	RMSE	317.5161	MAPE	4271.5824
2024-09-15 14:40:44,698 - T:Avg	MAE	182.2760	RMSE	269.1273	MAPE	3225.5680
2024-09-15 14:40:44,699 - Finished optimization, total time:9.96 s, best model:log/ENGERY/oneline_st_nn_engery-47/0/163.1819.pkl
2024-09-15 14:40:44,711 - [*] Year 1 load from data/ENGERY/FastData/1.npz
2024-09-15 14:40:44,712 - [*] load from log/ENGERY/oneline_st_nn_engery-47/0/163.1819.pkl
2024-09-15 14:40:44,766 - number of increase nodes:9, nodes after 2 hop:torch.Size([112]), total nodes this year 112
2024-09-15 14:40:44,937 - [*] Year 1 Dataset load!
2024-09-15 14:40:44,938 - [*] load from log/ENGERY/oneline_st_nn_engery-47/0/163.1819.pkl
2024-09-15 14:40:44,940 - Total Parameters: 3308
2024-09-15 14:40:44,940 - Trainable Parameters: 3308
2024-09-15 14:40:44,941 - [*] Year 1 Training start
2024-09-15 14:40:45,544 - node number torch.Size([14336, 12])
2024-09-15 14:40:47,002 - epoch:0, training loss:61295.6724 validation loss:195.7961
2024-09-15 14:40:48,764 - epoch:1, training loss:59188.8891 validation loss:191.6217
2024-09-15 14:40:50,530 - epoch:2, training loss:59340.5919 validation loss:201.5110
2024-09-15 14:40:52,239 - epoch:3, training loss:58706.2628 validation loss:193.1826
2024-09-15 14:40:54,017 - epoch:4, training loss:57729.1892 validation loss:192.2123
2024-09-15 14:40:55,718 - epoch:5, training loss:57461.3498 validation loss:201.7121
2024-09-15 14:40:57,470 - epoch:6, training loss:57150.1384 validation loss:211.5898
2024-09-15 14:40:59,241 - epoch:7, training loss:57761.8604 validation loss:181.0144
2024-09-15 14:41:00,908 - epoch:8, training loss:57799.1149 validation loss:200.0158
2024-09-15 14:41:02,584 - epoch:9, training loss:56286.0328 validation loss:197.3874
2024-09-15 14:41:04,353 - epoch:10, training loss:56191.5356 validation loss:188.3323
2024-09-15 14:41:06,065 - epoch:11, training loss:56008.5567 validation loss:200.2795
2024-09-15 14:41:07,745 - epoch:12, training loss:56652.0260 validation loss:199.7297
2024-09-15 14:41:09,503 - epoch:13, training loss:56675.7326 validation loss:190.0770
2024-09-15 14:41:10,223 - [*] loss:59949.8477
2024-09-15 14:41:10,229 - [*] year 1, testing
2024-09-15 14:41:10,266 - T:3	MAE	105.0967	RMSE	166.5559	MAPE	3169.4071
2024-09-15 14:41:10,335 - T:6	MAE	129.0991	RMSE	200.2151	MAPE	5115.7494
2024-09-15 14:41:10,556 - T:12	MAE	165.7498	RMSE	247.1710	MAPE	8544.3161
2024-09-15 14:41:10,556 - T:Avg	MAE	129.8383	RMSE	199.7061	MAPE	5366.8000
2024-09-15 14:41:10,557 - Finished optimization, total time:14.42 s, best model:log/ENGERY/oneline_st_nn_engery-47/1/181.0144.pkl
2024-09-15 14:41:10,574 - [*] Year 2 load from data/ENGERY/FastData/2.npz
2024-09-15 14:41:10,575 - [*] load from log/ENGERY/oneline_st_nn_engery-47/1/181.0144.pkl
2024-09-15 14:41:10,640 - number of increase nodes:10, nodes after 2 hop:torch.Size([122]), total nodes this year 122
2024-09-15 14:41:10,821 - [*] Year 2 Dataset load!
2024-09-15 14:41:10,821 - [*] load from log/ENGERY/oneline_st_nn_engery-47/1/181.0144.pkl
2024-09-15 14:41:10,823 - Total Parameters: 3308
2024-09-15 14:41:10,823 - Trainable Parameters: 3308
2024-09-15 14:41:10,824 - [*] Year 2 Training start
2024-09-15 14:41:11,513 - node number torch.Size([15616, 12])
2024-09-15 14:41:12,622 - epoch:0, training loss:53748.6978 validation loss:185.1361
2024-09-15 14:41:14,292 - epoch:1, training loss:52899.0732 validation loss:181.2559
2024-09-15 14:41:16,042 - epoch:2, training loss:51467.9061 validation loss:179.2991
2024-09-15 14:41:17,778 - epoch:3, training loss:51034.5613 validation loss:197.9985
2024-09-15 14:41:19,582 - epoch:4, training loss:51566.5339 validation loss:155.4055
2024-09-15 14:41:21,309 - epoch:5, training loss:50675.0756 validation loss:185.3867
2024-09-15 14:41:23,034 - epoch:6, training loss:51492.5615 validation loss:164.7770
2024-09-15 14:41:24,782 - epoch:7, training loss:50574.5434 validation loss:165.5000
2024-09-15 14:41:26,575 - epoch:8, training loss:51303.4359 validation loss:176.6371
2024-09-15 14:41:28,344 - epoch:9, training loss:50539.9273 validation loss:151.2477
2024-09-15 14:41:30,068 - epoch:10, training loss:50194.1962 validation loss:149.7132
2024-09-15 14:41:31,854 - epoch:11, training loss:50250.4958 validation loss:169.3127
2024-09-15 14:41:33,673 - epoch:12, training loss:50059.2631 validation loss:155.8394
2024-09-15 14:41:35,473 - epoch:13, training loss:50213.6799 validation loss:146.9975
2024-09-15 14:41:37,217 - epoch:14, training loss:49702.6764 validation loss:168.6583
2024-09-15 14:41:39,002 - epoch:15, training loss:49436.7452 validation loss:173.1321
2024-09-15 14:41:40,679 - epoch:16, training loss:50047.9096 validation loss:185.3936
2024-09-15 14:41:42,492 - epoch:17, training loss:49091.9093 validation loss:152.3015
2024-09-15 14:41:44,243 - epoch:18, training loss:49349.3597 validation loss:159.0951
2024-09-15 14:41:45,992 - epoch:19, training loss:49731.6467 validation loss:149.8587
2024-09-15 14:41:46,719 - [*] loss:44661.4258
2024-09-15 14:41:46,725 - [*] year 2, testing
2024-09-15 14:41:46,769 - T:3	MAE	82.9762	RMSE	137.0837	MAPE	2072.2219
2024-09-15 14:41:46,849 - T:6	MAE	106.8044	RMSE	171.0970	MAPE	3441.6569
2024-09-15 14:41:47,083 - T:12	MAE	138.9493	RMSE	215.1077	MAPE	5844.8666
2024-09-15 14:41:47,083 - T:Avg	MAE	106.4629	RMSE	169.4502	MAPE	3631.1153
2024-09-15 14:41:47,083 - Finished optimization, total time:20.56 s, best model:log/ENGERY/oneline_st_nn_engery-47/2/146.9975.pkl
2024-09-15 14:41:47,101 - [*] Year 3 load from data/ENGERY/FastData/3.npz
2024-09-15 14:41:47,102 - [*] load from log/ENGERY/oneline_st_nn_engery-47/2/146.9975.pkl
2024-09-15 14:41:47,165 - number of increase nodes:12, nodes after 2 hop:torch.Size([134]), total nodes this year 134
2024-09-15 14:41:47,362 - [*] Year 3 Dataset load!
2024-09-15 14:41:47,362 - [*] load from log/ENGERY/oneline_st_nn_engery-47/2/146.9975.pkl
2024-09-15 14:41:47,365 - Total Parameters: 3308
2024-09-15 14:41:47,365 - Trainable Parameters: 3308
2024-09-15 14:41:47,365 - [*] Year 3 Training start
2024-09-15 14:41:48,084 - node number torch.Size([17152, 12])
2024-09-15 14:41:49,322 - epoch:0, training loss:31243.7573 validation loss:115.6606
2024-09-15 14:41:51,140 - epoch:1, training loss:30759.7666 validation loss:108.8468
2024-09-15 14:41:52,947 - epoch:2, training loss:30215.5075 validation loss:116.8438
2024-09-15 14:41:54,794 - epoch:3, training loss:30920.9155 validation loss:130.5918
2024-09-15 14:41:56,623 - epoch:4, training loss:30273.0367 validation loss:114.9189
2024-09-15 14:41:58,503 - epoch:5, training loss:30117.8070 validation loss:125.4886
2024-09-15 14:42:00,292 - epoch:6, training loss:30409.1972 validation loss:108.6204
2024-09-15 14:42:02,159 - epoch:7, training loss:30098.1561 validation loss:119.0766
2024-09-15 14:42:03,920 - epoch:8, training loss:30293.5789 validation loss:120.1529
2024-09-15 14:42:05,716 - epoch:9, training loss:30771.2052 validation loss:118.9685
2024-09-15 14:42:07,493 - epoch:10, training loss:29814.9093 validation loss:133.7724
2024-09-15 14:42:09,308 - epoch:11, training loss:29781.5142 validation loss:118.3134
2024-09-15 14:42:11,081 - epoch:12, training loss:30407.0736 validation loss:115.3524
2024-09-15 14:42:11,811 - [*] loss:98553.3359
2024-09-15 14:42:11,817 - [*] year 3, testing
2024-09-15 14:42:11,861 - T:3	MAE	259.3850	RMSE	334.0982	MAPE	32887.6556
2024-09-15 14:42:11,948 - T:6	MAE	254.2706	RMSE	326.7833	MAPE	33930.0842
2024-09-15 14:42:12,157 - T:12	MAE	251.5373	RMSE	323.2860	MAPE	36168.1122
2024-09-15 14:42:12,157 - T:Avg	MAE	255.3378	RMSE	328.4915	MAPE	34126.8133
2024-09-15 14:42:12,158 - Finished optimization, total time:13.94 s, best model:log/ENGERY/oneline_st_nn_engery-47/3/108.6204.pkl
2024-09-15 14:42:12,159 - 


2024-09-15 14:42:12,160 - 3   	 MAE	    159.22	    105.10	     82.98	    259.39		  151.67
2024-09-15 14:42:12,160 - 3   	RMSE	    236.14	    166.56	    137.08	    334.10		  218.47
2024-09-15 14:42:12,160 - 3   	MAPE	   2552.08	   3169.41	   2072.22	  32887.66		10170.34
2024-09-15 14:42:12,160 - 6   	 MAE	    181.31	    129.10	    106.80	    254.27		  167.87
2024-09-15 14:42:12,160 - 6   	RMSE	    268.42	    200.22	    171.10	    326.78		  241.63
2024-09-15 14:42:12,160 - 6   	MAPE	   3096.60	   5115.75	   3441.66	  33930.08		11396.02
2024-09-15 14:42:12,160 - 12  	 MAE	    216.42	    165.75	    138.95	    251.54		  193.16
2024-09-15 14:42:12,160 - 12  	RMSE	    317.52	    247.17	    215.11	    323.29		  275.77
2024-09-15 14:42:12,160 - 12  	MAPE	   4271.58	   8544.32	   5844.87	  36168.11		13707.22
2024-09-15 14:42:12,160 - Avg 	 MAE	    182.28	    129.84	    106.46	    255.34		  168.48
2024-09-15 14:42:12,160 - Avg 	RMSE	    269.13	    199.71	    169.45	    328.49		  241.69
2024-09-15 14:42:12,160 - Avg 	MAPE	   3225.57	   5366.80	   3631.12	  34126.81		11587.57
2024-09-15 14:42:12,160 - year	0   	total_time	    9.9621	average_time	    0.8302	epoch	12
2024-09-15 14:42:12,160 - year	1   	total_time	   14.4156	average_time	    1.0297	epoch	14
2024-09-15 14:42:12,160 - year	2   	total_time	   20.5610	average_time	    1.0281	epoch	20
2024-09-15 14:42:12,160 - year	3   	total_time	   13.9405	average_time	    1.0724	epoch	13
2024-09-15 14:42:12,161 - total time: 58.8793
