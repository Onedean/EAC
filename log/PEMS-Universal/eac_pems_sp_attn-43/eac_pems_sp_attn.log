2024-10-01 03:31:36,586 - logger name:log/PEMS-Universal/eac_pems_sp_attn-43/eac_pems_sp_attn.log
2024-10-01 03:31:36,586 - params : {'conf': 'new_conf/PEMS-Universal/eac_pems_sp_attn.json', 'seed': 43, 'paral': 0, 'gpuid': 3, 'logname': 'eac_pems_sp_attn', 'method': 'Universal', 'load_first_year': 1, 'first_year_model_path': 'log/PEMS-Universal/eac_pems_sp_attn-44/2011/15.2338.pkl', 'device': device(type='cuda', index=3), 'methods': {'TrafficStream': <class 'src.model.model.TrafficStream_Model'>, 'STKEC': <class 'src.model.model.STKEC_Model'>, 'EAC': <class 'src.model.model.EAC_Model'>, 'Universal': <class 'src.model.model.Universal_Model'>}, 'begin_year': 2011, 'end_year': 2017, 'dropout': 0.0, 'lr': 0.03, 'batch_size': 128, 'epoch': 100, 'loss': 'mse', 'activation': 'relu', 'scheduler': 'epo', 'y_len': 12, 'x_len': 12, 'data_process': 0, 'raw_data_path': 'data/PEMS-Universal/RawData/', 'save_data_path': 'data/PEMS-Universal/FastData/', 'graph_path': 'data/PEMS-Universal/graph/', 'model_path': 'log/PEMS-Universal/', 'gcn': {'in_channel': 12, 'out_channel': 12, 'hidden_channel': 64}, 'tcn': {'in_channel': 1, 'out_channel': 1, 'kernel_size': 3, 'dilation': 1}, 'use_eac': True, 'gcn_type': 'sp', 'tcn_type': 'attn', 'rank': 12, 'init': True, 'train': 1, 'auto_test': 0, 'strategy': 'retrain', 'detect': False, 'ewc': False, 'replay': False, 'path': 'log/PEMS-Universal/eac_pems_sp_attn-43', 'logger': <Logger utils.initialize (INFO)>}
2024-10-01 03:31:36,601 - [*] Year 2011 load from data/PEMS-Universal/FastData/2011.npz
2024-10-01 03:31:37,868 - [*] load from log/PEMS-Universal/eac_pems_sp_attn-44/2011/15.2338.pkl
2024-10-01 03:31:40,749 - [*] loss:486.7231
2024-10-01 03:31:40,867 - [*] year 2011, testing
2024-10-01 03:31:41,827 - T:3	MAE	13.0770	RMSE	19.4200	MAPE	17.8458
2024-10-01 03:31:42,549 - T:6	MAE	13.5452	RMSE	20.2204	MAPE	18.3536
2024-10-01 03:31:45,087 - T:12	MAE	14.8056	RMSE	22.2432	MAPE	20.2820
2024-10-01 03:31:45,088 - T:Avg	MAE	13.6972	RMSE	20.4442	MAPE	18.6424
2024-10-01 03:31:45,102 - [*] Year 2012 load from data/PEMS-Universal/FastData/2012.npz
2024-10-01 03:31:46,117 - [*] Year 2012 Dataset load!
2024-10-01 03:31:46,117 - [*] load from log/PEMS-Universal/eac_pems_sp_attn-44/2011/15.2338.pkl
2024-10-01 03:31:46,122 - Total Parameters: 30204
2024-10-01 03:31:46,122 - Trainable Parameters: 25364
2024-10-01 03:31:46,122 - [*] Year 2012 Training start
2024-10-01 03:31:48,701 - node number torch.Size([91520, 12])
2024-10-01 03:31:57,771 - epoch:0, training loss:991.1187 validation loss:15.4159
2024-10-01 03:32:06,880 - epoch:1, training loss:517.6570 validation loss:14.7640
2024-10-01 03:32:16,347 - epoch:2, training loss:499.0906 validation loss:15.4723
2024-10-01 03:32:25,228 - epoch:3, training loss:500.5432 validation loss:14.8611
2024-10-01 03:32:34,465 - epoch:4, training loss:502.2279 validation loss:15.4955
2024-10-01 03:32:42,765 - epoch:5, training loss:502.7965 validation loss:15.1831
2024-10-01 03:32:51,776 - epoch:6, training loss:502.8377 validation loss:15.5121
2024-10-01 03:32:59,736 - epoch:7, training loss:494.2304 validation loss:15.0519
2024-10-01 03:33:03,128 - [*] loss:507.3958
2024-10-01 03:33:03,182 - [*] year 2012, testing
2024-10-01 03:33:03,493 - T:3	MAE	12.7550	RMSE	19.5090	MAPE	19.1007
2024-10-01 03:33:04,095 - T:6	MAE	13.3789	RMSE	20.4855	MAPE	19.7849
2024-10-01 03:33:06,006 - T:12	MAE	14.8044	RMSE	22.7090	MAPE	21.7050
2024-10-01 03:33:06,006 - T:Avg	MAE	13.5076	RMSE	20.6846	MAPE	19.9755
2024-10-01 03:33:06,008 - Finished optimization, total time:58.95 s, best model:log/PEMS-Universal/eac_pems_sp_attn-43/2012/14.764.pkl
2024-10-01 03:33:06,030 - [*] Year 2013 load from data/PEMS-Universal/FastData/2013.npz
2024-10-01 03:33:06,937 - [*] Year 2013 Dataset load!
2024-10-01 03:33:06,938 - [*] load from log/PEMS-Universal/eac_pems_sp_attn-43/2012/14.764.pkl
2024-10-01 03:33:07,363 - Total Parameters: 31056
2024-10-01 03:33:07,363 - Trainable Parameters: 26216
2024-10-01 03:33:07,363 - [*] Year 2013 Training start
2024-10-01 03:33:08,524 - node number torch.Size([100608, 12])
2024-10-01 03:33:16,022 - epoch:0, training loss:1742.5360 validation loss:18.1728
2024-10-01 03:33:25,822 - epoch:1, training loss:576.4636 validation loss:15.4800
2024-10-01 03:33:35,003 - epoch:2, training loss:508.6092 validation loss:15.1382
2024-10-01 03:33:44,358 - epoch:3, training loss:488.4552 validation loss:14.8754
2024-10-01 03:33:53,049 - epoch:4, training loss:479.5654 validation loss:14.6717
2024-10-01 03:34:01,223 - epoch:5, training loss:470.8654 validation loss:14.6626
2024-10-01 03:34:10,125 - epoch:6, training loss:466.4859 validation loss:14.4760
2024-10-01 03:34:18,930 - epoch:7, training loss:466.5815 validation loss:14.3849
2024-10-01 03:34:27,964 - epoch:8, training loss:465.4929 validation loss:15.2638
2024-10-01 03:34:36,885 - epoch:9, training loss:477.1153 validation loss:14.4480
2024-10-01 03:34:45,948 - epoch:10, training loss:456.8237 validation loss:14.2562
2024-10-01 03:34:55,493 - epoch:11, training loss:461.7111 validation loss:14.3165
2024-10-01 03:35:04,903 - epoch:12, training loss:460.1585 validation loss:14.3063
2024-10-01 03:35:14,095 - epoch:13, training loss:454.9590 validation loss:14.1940
2024-10-01 03:35:23,517 - epoch:14, training loss:455.3457 validation loss:14.7262
2024-10-01 03:35:31,804 - epoch:15, training loss:458.0292 validation loss:14.2630
2024-10-01 03:35:39,948 - epoch:16, training loss:452.9446 validation loss:15.1296
2024-10-01 03:35:48,515 - epoch:17, training loss:451.7502 validation loss:14.6698
2024-10-01 03:35:58,130 - epoch:18, training loss:480.1109 validation loss:14.7575
2024-10-01 03:36:07,340 - epoch:19, training loss:476.6796 validation loss:14.3914
2024-10-01 03:36:10,982 - [*] loss:490.3943
2024-10-01 03:36:11,013 - [*] year 2013, testing
2024-10-01 03:36:11,343 - T:3	MAE	12.7404	RMSE	19.6547	MAPE	20.2362
2024-10-01 03:36:12,022 - T:6	MAE	13.1956	RMSE	20.5088	MAPE	20.8281
2024-10-01 03:36:14,257 - T:12	MAE	14.2667	RMSE	22.2945	MAPE	22.4864
2024-10-01 03:36:14,257 - T:Avg	MAE	13.3008	RMSE	20.6532	MAPE	20.9867
2024-10-01 03:36:14,259 - Finished optimization, total time:142.67 s, best model:log/PEMS-Universal/eac_pems_sp_attn-43/2013/14.194.pkl
2024-10-01 03:36:14,283 - [*] Year 2014 load from data/PEMS-Universal/FastData/2014.npz
2024-10-01 03:36:15,231 - [*] Year 2014 Dataset load!
2024-10-01 03:36:15,231 - [*] load from log/PEMS-Universal/eac_pems_sp_attn-43/2013/14.194.pkl
2024-10-01 03:36:15,634 - Total Parameters: 31488
2024-10-01 03:36:15,634 - Trainable Parameters: 26648
2024-10-01 03:36:15,635 - [*] Year 2014 Training start
2024-10-01 03:36:16,699 - node number torch.Size([105216, 12])
2024-10-01 03:36:25,237 - epoch:0, training loss:1085.8982 validation loss:16.5410
2024-10-01 03:36:34,710 - epoch:1, training loss:605.9208 validation loss:15.5039
2024-10-01 03:36:45,259 - epoch:2, training loss:585.2868 validation loss:15.2756
2024-10-01 03:36:55,190 - epoch:3, training loss:581.0953 validation loss:15.6801
2024-10-01 03:37:04,889 - epoch:4, training loss:599.4061 validation loss:15.4045
2024-10-01 03:37:14,902 - epoch:5, training loss:568.3501 validation loss:15.1619
2024-10-01 03:37:24,902 - epoch:6, training loss:570.8178 validation loss:15.3766
2024-10-01 03:37:33,051 - epoch:7, training loss:572.6737 validation loss:15.9636
2024-10-01 03:37:42,862 - epoch:8, training loss:597.0114 validation loss:15.2397
2024-10-01 03:37:53,062 - epoch:9, training loss:572.7278 validation loss:15.3777
2024-10-01 03:38:02,995 - epoch:10, training loss:572.3038 validation loss:15.7047
2024-10-01 03:38:12,759 - epoch:11, training loss:563.0184 validation loss:15.4200
2024-10-01 03:38:16,900 - [*] loss:524.2844
2024-10-01 03:38:16,942 - [*] year 2014, testing
2024-10-01 03:38:17,279 - T:3	MAE	13.3814	RMSE	21.0309	MAPE	19.7582
2024-10-01 03:38:18,142 - T:6	MAE	13.7628	RMSE	21.7133	MAPE	20.1851
2024-10-01 03:38:20,958 - T:12	MAE	14.6430	RMSE	23.1093	MAPE	21.5180
2024-10-01 03:38:20,958 - T:Avg	MAE	13.8461	RMSE	21.8141	MAPE	20.3279
2024-10-01 03:38:20,962 - Finished optimization, total time:92.39 s, best model:log/PEMS-Universal/eac_pems_sp_attn-43/2014/15.1619.pkl
2024-10-01 03:38:20,991 - [*] Year 2015 load from data/PEMS-Universal/FastData/2015.npz
2024-10-01 03:38:22,119 - [*] Year 2015 Dataset load!
2024-10-01 03:38:22,119 - [*] load from log/PEMS-Universal/eac_pems_sp_attn-43/2014/15.1619.pkl
2024-10-01 03:38:22,470 - Total Parameters: 31632
2024-10-01 03:38:22,470 - Trainable Parameters: 26792
2024-10-01 03:38:22,471 - [*] Year 2015 Training start
2024-10-01 03:38:23,726 - node number torch.Size([106752, 12])
2024-10-01 03:38:32,775 - epoch:0, training loss:1551.9652 validation loss:16.2519
2024-10-01 03:38:42,600 - epoch:1, training loss:641.7154 validation loss:15.0959
2024-10-01 03:38:53,048 - epoch:2, training loss:606.3607 validation loss:14.6207
2024-10-01 03:39:03,103 - epoch:3, training loss:592.7592 validation loss:14.3679
2024-10-01 03:39:13,011 - epoch:4, training loss:586.4406 validation loss:14.3683
2024-10-01 03:39:22,734 - epoch:5, training loss:585.6563 validation loss:14.5922
2024-10-01 03:39:32,998 - epoch:6, training loss:580.4155 validation loss:14.4681
2024-10-01 03:39:40,582 - epoch:7, training loss:578.8442 validation loss:14.4078
2024-10-01 03:39:50,212 - epoch:8, training loss:583.0376 validation loss:15.0322
2024-10-01 03:40:00,428 - epoch:9, training loss:569.5886 validation loss:14.5956
2024-10-01 03:40:04,853 - [*] loss:535.6091
2024-10-01 03:40:04,899 - [*] year 2015, testing
2024-10-01 03:40:05,327 - T:3	MAE	13.2046	RMSE	20.8712	MAPE	20.3079
2024-10-01 03:40:06,121 - T:6	MAE	13.5826	RMSE	21.7153	MAPE	20.5640
2024-10-01 03:40:08,516 - T:12	MAE	14.3986	RMSE	23.3715	MAPE	21.3578
2024-10-01 03:40:08,516 - T:Avg	MAE	13.6439	RMSE	21.8187	MAPE	20.5990
2024-10-01 03:40:08,518 - Finished optimization, total time:76.66 s, best model:log/PEMS-Universal/eac_pems_sp_attn-43/2015/14.3679.pkl
2024-10-01 03:40:08,544 - [*] Year 2016 load from data/PEMS-Universal/FastData/2016.npz
2024-10-01 03:40:09,510 - [*] Year 2016 Dataset load!
2024-10-01 03:40:09,511 - [*] load from log/PEMS-Universal/eac_pems_sp_attn-43/2015/14.3679.pkl
2024-10-01 03:40:09,973 - Total Parameters: 31824
2024-10-01 03:40:09,973 - Trainable Parameters: 26984
2024-10-01 03:40:09,974 - [*] Year 2016 Training start
2024-10-01 03:40:11,091 - node number torch.Size([108800, 12])
2024-10-01 03:40:20,183 - epoch:0, training loss:1026.0300 validation loss:15.0094
2024-10-01 03:40:29,427 - epoch:1, training loss:632.2134 validation loss:14.4072
2024-10-01 03:40:38,024 - epoch:2, training loss:619.6714 validation loss:14.3418
2024-10-01 03:40:49,067 - epoch:3, training loss:610.7094 validation loss:14.3542
2024-10-01 03:40:59,160 - epoch:4, training loss:611.6258 validation loss:14.2315
2024-10-01 03:41:09,836 - epoch:5, training loss:604.9605 validation loss:14.2301
2024-10-01 03:41:20,418 - epoch:6, training loss:598.4221 validation loss:14.0912
2024-10-01 03:41:30,938 - epoch:7, training loss:611.7209 validation loss:14.3309
2024-10-01 03:41:41,392 - epoch:8, training loss:602.9067 validation loss:14.6469
2024-10-01 03:41:51,379 - epoch:9, training loss:613.1143 validation loss:14.3822
2024-10-01 03:42:02,522 - epoch:10, training loss:616.3138 validation loss:14.4849
2024-10-01 03:42:08,917 - epoch:11, training loss:610.2844 validation loss:14.4091
2024-10-01 03:42:16,338 - epoch:12, training loss:600.7878 validation loss:14.3573
2024-10-01 03:42:20,285 - [*] loss:591.2754
2024-10-01 03:42:20,318 - [*] year 2016, testing
2024-10-01 03:42:20,653 - T:3	MAE	12.3809	RMSE	21.2443	MAPE	17.6945
2024-10-01 03:42:21,368 - T:6	MAE	12.8833	RMSE	22.4647	MAPE	18.3122
2024-10-01 03:42:23,721 - T:12	MAE	13.9323	RMSE	24.5183	MAPE	19.4288
2024-10-01 03:42:23,721 - T:Avg	MAE	12.9679	RMSE	22.5305	MAPE	18.3390
2024-10-01 03:42:23,723 - Finished optimization, total time:100.84 s, best model:log/PEMS-Universal/eac_pems_sp_attn-43/2016/14.0912.pkl
2024-10-01 03:42:23,761 - [*] Year 2017 load from data/PEMS-Universal/FastData/2017.npz
2024-10-01 03:42:24,749 - [*] Year 2017 Dataset load!
2024-10-01 03:42:24,749 - [*] load from log/PEMS-Universal/eac_pems_sp_attn-43/2016/14.0912.pkl
2024-10-01 03:42:25,250 - Total Parameters: 32076
2024-10-01 03:42:25,250 - Trainable Parameters: 27236
2024-10-01 03:42:25,251 - [*] Year 2017 Training start
2024-10-01 03:42:26,470 - node number torch.Size([111488, 12])
2024-10-01 03:42:36,151 - epoch:0, training loss:1831.7045 validation loss:17.1423
2024-10-01 03:42:46,419 - epoch:1, training loss:734.4855 validation loss:16.2605
2024-10-01 03:42:57,468 - epoch:2, training loss:695.8239 validation loss:16.1002
2024-10-01 03:43:08,573 - epoch:3, training loss:682.8973 validation loss:15.8874
2024-10-01 03:43:19,213 - epoch:4, training loss:679.6348 validation loss:15.6900
2024-10-01 03:43:29,515 - epoch:5, training loss:669.8068 validation loss:15.5008
2024-10-01 03:43:39,438 - epoch:6, training loss:672.8754 validation loss:15.7246
2024-10-01 03:43:50,140 - epoch:7, training loss:666.6074 validation loss:16.3392
2024-10-01 03:44:00,201 - epoch:8, training loss:661.5802 validation loss:15.7222
2024-10-01 03:44:10,810 - epoch:9, training loss:663.6139 validation loss:15.7739
2024-10-01 03:44:20,624 - epoch:10, training loss:657.6458 validation loss:15.7303
2024-10-01 03:44:30,146 - epoch:11, training loss:661.7977 validation loss:17.0991
2024-10-01 03:44:34,242 - [*] loss:620.2624
2024-10-01 03:44:34,271 - [*] year 2017, testing
2024-10-01 03:44:34,592 - T:3	MAE	13.7542	RMSE	22.0474	MAPE	18.8274
2024-10-01 03:44:35,326 - T:6	MAE	14.3045	RMSE	23.0889	MAPE	19.3500
2024-10-01 03:44:37,571 - T:12	MAE	15.4979	RMSE	25.1248	MAPE	20.5368
2024-10-01 03:44:37,571 - T:Avg	MAE	14.3989	RMSE	23.2108	MAPE	19.4216
2024-10-01 03:44:37,573 - Finished optimization, total time:97.43 s, best model:log/PEMS-Universal/eac_pems_sp_attn-43/2017/15.5008.pkl
2024-10-01 03:44:37,582 - 


2024-10-01 03:44:37,582 - 3   	 MAE	     13.08	     12.75	     12.74	     13.38	     13.20	     12.38	     13.75		   13.04
2024-10-01 03:44:37,582 - 3   	RMSE	     19.42	     19.51	     19.65	     21.03	     20.87	     21.24	     22.05		   20.54
2024-10-01 03:44:37,582 - 3   	MAPE	     17.85	     19.10	     20.24	     19.76	     20.31	     17.69	     18.83		   19.11
2024-10-01 03:44:37,582 - 6   	 MAE	     13.55	     13.38	     13.20	     13.76	     13.58	     12.88	     14.30		   13.52
2024-10-01 03:44:37,582 - 6   	RMSE	     20.22	     20.49	     20.51	     21.71	     21.72	     22.46	     23.09		   21.46
2024-10-01 03:44:37,582 - 6   	MAPE	     18.35	     19.78	     20.83	     20.19	     20.56	     18.31	     19.35		   19.63
2024-10-01 03:44:37,582 - 12  	 MAE	     14.81	     14.80	     14.27	     14.64	     14.40	     13.93	     15.50		   14.62
2024-10-01 03:44:37,582 - 12  	RMSE	     22.24	     22.71	     22.29	     23.11	     23.37	     24.52	     25.12		   23.34
2024-10-01 03:44:37,583 - 12  	MAPE	     20.28	     21.71	     22.49	     21.52	     21.36	     19.43	     20.54		   21.04
2024-10-01 03:44:37,583 - Avg 	 MAE	     13.70	     13.51	     13.30	     13.85	     13.64	     12.97	     14.40		   13.62
2024-10-01 03:44:37,583 - Avg 	RMSE	     20.44	     20.68	     20.65	     21.81	     21.82	     22.53	     23.21		   21.59
2024-10-01 03:44:37,583 - Avg 	MAPE	     18.64	     19.98	     20.99	     20.33	     20.60	     18.34	     19.42		   19.76
2024-10-01 03:44:37,583 - year	2012	total_time	   58.9537	average_time	    7.3692	epoch	8
2024-10-01 03:44:37,583 - year	2013	total_time	  142.6718	average_time	    7.1336	epoch	20
2024-10-01 03:44:37,583 - year	2014	total_time	   92.3890	average_time	    7.6991	epoch	12
2024-10-01 03:44:37,583 - year	2015	total_time	   76.6598	average_time	    7.6660	epoch	10
2024-10-01 03:44:37,583 - year	2016	total_time	  100.8409	average_time	    7.7570	epoch	13
2024-10-01 03:44:37,583 - year	2017	total_time	   97.4309	average_time	    8.1193	epoch	12
2024-10-01 03:44:37,583 - total time: 568.9461
